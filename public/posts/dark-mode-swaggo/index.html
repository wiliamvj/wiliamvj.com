<!DOCTYPE html>
<html lang="pt" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script> 

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Como deixar o Swagger com tema dark mode usando Swaggo e Golang</title>
<meta name="description" content="Recentemente criei um port mostrando como deixar o Swagger com tema dark mode utilizando NestJS, agora vou mostrar como deixar o Swagger em dark mode utilizando o Swaggo com Go.">
<link rel="canonical" href="//localhost:1313/posts/dark-mode-swaggo/">
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="//localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto">
    <div class="header">
      <header
  class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 sm:py-12"
>
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="//localhost:1313/">
    <img
      srcset="/img/profile-picture_hucbf2afd9e62dc6021c155b0731b41164_625734_80x80_fill_q90_box_smart1.jpg 80w"
      src="/img/profile-picture.jpg"
      width="1080"
      height="1080"
      alt="Wiliam V. Joaquim"
    />
  </a>
</div>


  <div class="flex flex-col gap-5">
    <a href="//localhost:1313/">
  <h1 id="site-title">Wiliam V<span class="text-wpurple">.</span> Joaquim</h1>
</a>
 <nav>
  <ul class="px-4 lg:px-0">
     
    <li>
      <a
        href="/"
        class=""
      >
        Artigos
      </a>
      <span class="text-wpurple text-lg">.</span>
    </li>
    
    <li>
      <a
        href="https://wiliamvj.substack.com/"
        class=""
      >
        Newsletter
      </a>
      <span class="text-wpurple text-lg">.</span>
    </li>
    
    <li>
      <a
        href="/en/"
        class=""
      >
        en-US
      </a>
      <span class="text-wpurple text-lg">.</span>
    </li>
    
    <li class="-mt-2 block lg:hidden"><button
  class="toggle-theme"
  aria-label="Toggle Theme"
  title="Toggle Theme"
  onclick="toggleTheme()"
>
  <span class="theme-icon light hidden dark:block">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg>
  </span>
  <span class="theme-icon dark block dark:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg>
  </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme !== 'light') {
      setTheme('dark');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
</li>
  </ul>
</nav>

  </div>
</header>

      <div class="lg:inline-block hidden">
        <button
  class="toggle-theme"
  aria-label="Toggle Theme"
  title="Toggle Theme"
  onclick="toggleTheme()"
>
  <span class="theme-icon light hidden dark:block">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg>
  </span>
  <span class="theme-icon dark block dark:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg>
  </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme !== 'light') {
      setTheme('dark');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>

      </div>
    </div>

    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-small">Como deixar o Swagger com tema dark mode usando Swaggo e Golang</h2>

    <div class="meta">
      
      <time
        datetime="2023-11-11 15:39:40 -0300 -03"
        title='Sat, Nov 11, 2023, 3:39 PM -03'
      >
        Publicado em: 11/11/2023 - 7 minutos de leitura
      </time>

       
    </div>
  </header>

  

  <section><p><img alt="thumbnail" src="/posts/dark-mode-swaggo/345kfh4ddlo08gw.png"></p>
<p>Recentemente criei um port mostrando como deixar o Swagger com tema dark mode utilizando <a href="posts/swagger-dark-nestjs/">NestJS</a>, agora vou mostrar como deixar o Swagger em dark mode utilizando o <a href="https://github.com/swaggo/swag">Swaggo</a> com Go.</p>
<h2 id="o-que-é-o-swaggo">O que é o Swaggo?</h2>
<p>O Swaggo é uma ferramenta que nos ajuda a documentar nossa API desenvolvida em <a href="https://go.dev/">GO</a>, gerando a documentação no padrão da <a href="https://www.openapis.org/">OpenAPI</a>.</p>
<p>Não vamos focar em como utilizar o Swaggo, mas vou deixar aqui um excelente post no <a href="https://dev.to/booscaaa/documentanto-uma-api-go-com-swagger-2k05">Dev.to</a> que ensina como fazer isso.</p>
<h2 id="criando-o-projeto-de-exemplo">Criando o projeto de exemplo</h2>
<p>Vamos criar um exemplo mais alinhado com uma utilização no mundo real, para isso vamos utilizar o <a href="https://go-chi.io/">Go Chi</a>, que é o roteador muito simples, mas que facilita muito na criação de rotas em Go.</p>
<p>Vamos iniciar o projeto rodando o comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">go</span> mod init swagger<span style="color:#ff79c6">-</span>dark<span style="color:#ff79c6">-</span>mode
</span></span></code></pre></div><p>Isso vai criar nosso arquivo <code>go.mod</code>, que vai servir para gerenciar nossos pacotes.</p>
<h2 id="organizando-o-projeto">Organizando o projeto</h2>
<p><img alt="Project structure" src="/posts/dark-mode-swaggo/fhvc908cxavb09bn0.png"></p>
<p>Vamos organizar seguindo um padrão muito utilizado pela comunidade do Go, você pode ver nesse <a href="https://github.com/golang-standards/project-layout">repositório</a></p>
<ul>
<li><strong>cmd</strong>: <a href="https://github.com/golang-standards/project-layout/tree/master/cmd">Aqui</a> é onde vamos deixar nosso arquivos que iniciam a nossa aplicação.
<ul>
<li><strong>webserver</strong>: Aqui é onde vamos deixar o <code>main.go</code> que inicia nosso webserver.</li>
</ul>
</li>
<li><strong>internal</strong>: <a href="https://github.com/golang-standards/project-layout/tree/master/internal">Nessa pasta</a> onde deve ficar todo o código da nossa aplicação.
<ul>
<li><strong>handler</strong>: Aqui vai ficar os arquivos responsáveis por receber nossas solicitações http, você pode conhecer também como controllers.
<ul>
<li><strong>routes</strong>: Aqui vamos organizar nossas rotas, incluido a rota da nossa documentação.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code>main.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;swagger-dark-mode/internal/handler/routes&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;github.com/go-chi/chi/v5&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    r <span style="color:#ff79c6">:=</span> chi.<span style="color:#50fa7b">NewRouter</span>()
</span></span><span style="display:flex;"><span>    routes.<span style="color:#50fa7b">InitRoutes</span>(r)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;Server running on port 8080&#34;</span>)
</span></span><span style="display:flex;"><span>    http.<span style="color:#50fa7b">ListenAndServe</span>(<span style="color:#f1fa8c">&#34;:8080&#34;</span>, r)
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>No arquivo <code>main.go</code>, iniciamos nosso router com go chi, iniciamos nossas rotas com <code>routes.InitRoutes()</code>, e damos start em nosso server que vai rodar na porta <code>8080</code></p>
<p>Você pode baixar os pacotes do go chi e swaggo com o comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  go get github.com/swaggo/http-swagger github.com/go-chi/chi/v5
</span></span></code></pre></div><p>É necessário instalar o swag na sua máquina, veja como neste <a href="https://github.com/swaggo/swag#getting-started">link</a></p>
<p><code>routes.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> routes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;swagger-dark-mode/internal/handler&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    _ <span style="color:#f1fa8c">&#34;swagger-dark-mode/docs&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;github.com/go-chi/chi/v5&#34;</span>
</span></span><span style="display:flex;"><span>    httpSwagger <span style="color:#f1fa8c">&#34;github.com/swaggo/http-swagger&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">var</span> (
</span></span><span style="display:flex;"><span>    docsURL = <span style="color:#f1fa8c">&#34;http://localhost:8080/docs/doc.json&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">//	@title		Swagger Dark Mode
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@version	1.0
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">InitRoutes</span>(r chi.Router) {
</span></span><span style="display:flex;"><span>    r.<span style="color:#50fa7b">Get</span>(<span style="color:#f1fa8c">&#34;/docs/*&#34;</span>, httpSwagger.<span style="color:#50fa7b">Handler</span>(httpSwagger.<span style="color:#50fa7b">URL</span>(docsURL)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    r.<span style="color:#50fa7b">Get</span>(<span style="color:#f1fa8c">&#34;/user&#34;</span>, handler.GetUser)
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>No arquivo <code>routes.go</code> é onde criamos nossas rotas, criamos uma rota do tipo GET <code>/user</code> que chama nosso handler <code>GetUser</code> e outra rota
GET para nossa docs <code>/docs/*</code> o <code>/*</code> após o path <code>docs</code>, indica que qualquer combinação de caracteres pode aparecer na posição correspondente.</p>
<p>o import <code>&quot;_ swagger-dark-mode/docs&quot;</code> vem da pasta gerada após iniciar o swag, usando o comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  swag init -g internal/handler/routes/routes.go
</span></span></code></pre></div><p>É necessário rodar esse comando sempre que houver alterações na sua documentação, o swag vai criar um pasta chamada docs, você não precisa alterar nada nessa pasta, veja como fica agora a estrutura do projeto:</p>
<p><img alt="Project structure" src="/posts/dark-mode-swaggo/9sd8fF45GHjgfgQ.png"></p>
<p>Dentro do <code>swagger.json</code> fica o arquivo no padrão da OpenAPI.</p>
<p>o caminho <code>internal/handler/routes/routes.go</code> deve ser onde está as anotações gerais do swag, no nosso caso setamos apenas o <code>@title</code> e o <code>@version</code>, veja todas as anotações possíveis <a href="https://github.com/swaggo/swag#general-api-info">aqui</a>.</p>
<p><code>user.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> handler
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;log/slog&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">type</span> User <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    ID    <span style="color:#8be9fd">int</span>    <span style="color:#f1fa8c">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    Name  <span style="color:#8be9fd">string</span> <span style="color:#f1fa8c">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>    Email <span style="color:#8be9fd">string</span> <span style="color:#f1fa8c">`json:&#34;email&#34;`</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">// Get fake user
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Summary		 Get Fake user
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Description Get Fake user for example
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Tags			   user
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Accept			 json
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Produce		 json
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Success		 200	{object}	User
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Failure		 500
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#6272a4">//	@Router			 /user [get]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">GetUser</span>(w http.ResponseWriter, r <span style="color:#ff79c6">*</span>http.Request) {
</span></span><span style="display:flex;"><span>    user <span style="color:#ff79c6">:=</span> User{
</span></span><span style="display:flex;"><span>      ID:    <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>      Name:  <span style="color:#f1fa8c">&#34;John Doe&#34;</span>,
</span></span><span style="display:flex;"><span>      Email: <span style="color:#f1fa8c">&#34;jonh.doe@email.com&#34;</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    userMarshal, err <span style="color:#ff79c6">:=</span> json.<span style="color:#50fa7b">Marshal</span>(user)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>      slog.<span style="color:#50fa7b">Error</span>(<span style="color:#f1fa8c">&#34;Error marshalling user&#34;</span>, err)
</span></span><span style="display:flex;"><span>      http.<span style="color:#50fa7b">Error</span>(w, err.<span style="color:#50fa7b">Error</span>(), http.StatusInternalServerError)
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    w.<span style="color:#50fa7b">Write</span>(userMarshal)
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Se desejar formatar suas anotações do swag basta rodar o comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  swag fmt
</span></span></code></pre></div><p>No arquivo <code>user.go</code> é onde podemos validar nossa requisição, onde podemos pegar o body por exemplo e transformar em um <a href="https://go.dev/ref/spec#Struct_types">struct go</a>. Criamos um user fake, fizemos o enconding da a struct <code>User</code> para Json usando <a href="https://pkg.go.dev/encoding/json#Marshal">Marshal</a>, caso não aconteça um erro duranto o Marshal, retornamos o json usando o <code>w.writer</code>.</p>
<h2 id="rodando-o-projeto">Rodando o projeto</h2>
<p>Tudo pronto para rodar o projeto, caso não tenha instalado os pacotes, rode o comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  go mod tidy
</span></span></code></pre></div><p>Esse comando vai no arquivo <code>go.mod</code> e faz o download das dependências.</p>
<p>Vamos iniciar o projeto, rodando nosso <code>main.go</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  go run cmd/webserver/main.go
</span></span></code></pre></div><p>Se tudo estiver correto, vamos ter no terminal a mensagem <em>Server running on port 8080</em>.</p>
<p>Acessando nossa rota via <code>http://localhost:8080/user</code> teremos esse resultado:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;John Doe&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;email&#34;</span>: <span style="color:#f1fa8c">&#34;jonh.doe@email.com&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Acessando nossa outra rota <code>http://localhost:8080/docs/index.html</code>, teremos nossa documentação com swagger:</p>
<p><img alt="Swaggo light" src="/posts/dark-mode-swaggo/sopfdf832nmf393n339RfgdfYH.png"></p>
<p><img alt="Meme my eyes" src="https://media4.giphy.com/media/84BjZMVEX3aRG/giphy.gif?cid=7941fdc6zrsyrot6atdj7as4jvaiplgkjqkf9188qmmz57u0&ep=v1_gifs_search&rid=giphy.gif&ct=g"></p>
<h2 id="criando-nosso-css-e-js">Criando nosso CSS e JS</h2>
<p>Bom, finalmente vamos ao intuito do post, deixar o tema do swagger em dark mode, infelizmente não existe nada nativo ou que seja simples quanto deixar o swagger em dark mode utilizando o <a href="https://nestjs.com/">NestJS</a>. <em>(Pelo menos até a data de pulbicação desse post)</em>.</p>
<p>Vamos precisar injetar nosso css customizado no swaggo, para isso você pode utilizar o css desse <a href="https://gist.github.com/wiliamvj/674cbdf6de5377780013e6ff2e5667c3">gist</a>, por´m também não conseguimos injetar o css diretamente, mas conseguimos injetar um JavaScript, com isso também se torna possível manipular a <a href="https://www.w3schools.com/js/js_htmldom.asp">DOM</a> e consequentemente injetar css.</p>
<p>Vamos criar uma pasta dentro da pasta <code>docs</code>, chamado <code>custom</code>, onde vamos colocar nossas customizações.</p>
<p><em>Você pode criar fora da pasta <code>docs</code>, já que é uma pasta gerada dinamicamente pelo swaggo, pode ser substituida e acabar perdendo sua customização</em>, mas para este exemplo vamos deixar dentro da pasta <code>docs</code> mesmo.</p>
<p>Dentro do custom vamos criar 2 arquivos, <code>custom_css.go</code> e <code>custom_layout.go</code>.</p>
<p><code>custom_css.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> custom
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">var</span> customCSS = <span style="color:#f1fa8c">`css do gist`</span>
</span></span></code></pre></div><p>No arquivo <code>custom_css.go</code>, apenas retornamos o css que deixe no <a href="https://gist.github.com/wiliamvj/674cbdf6de5377780013e6ff2e5667c3">gist</a> em string.</p>
<p><code>custom_layout.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> custom
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">import</span> <span style="color:#f1fa8c">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">var</span> CustomLayoutJS = fmt.<span style="color:#50fa7b">Sprintf</span>(<span style="color:#f1fa8c">`
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      // dark mode
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      const style = document.createElement(&#39;style&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      style.innerHTML = %s;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      document.head.appendChild(style);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    `</span>, <span style="color:#f1fa8c">&#34;`&#34;</span><span style="color:#ff79c6">+</span>customCSS<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;`&#34;</span>)
</span></span></code></pre></div><p>No arquivo <code>custom_layout.go</code> criamos noss JavaScript para ser injetado em nosso swagger, criamos uma tag style e adicionamos ao DOM, convertamos em string utilizando o <code>Sprintf</code> do pacote <a href="https://pkg.go.dev/fmt">fmt</a>, veja um post meu sobre o pacote fmt <a href="/posts/fmt-go/">aqui</a>.</p>
<p><code>&quot;&quot;+customCSS+&quot;&quot;</code>, isso envolve o arquivo JS em aspas duplas.</p>
<h2 id="aplicando-o-dark-mode">Aplicando o Dark mode</h2>
<p>Vamos finalmente aplicar nosso dark mode, para isso vamos alterar no arquivo <code>routes.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">InitRoutes</span>(r chi.Router) {
</span></span><span style="display:flex;"><span>    r.<span style="color:#50fa7b">Get</span>(<span style="color:#f1fa8c">&#34;/docs/*&#34;</span>, httpSwagger.<span style="color:#50fa7b">Handler</span>(httpSwagger.<span style="color:#50fa7b">URL</span>(docsURL),
</span></span><span style="display:flex;"><span>      httpSwagger.<span style="color:#50fa7b">AfterScript</span>(custom.CustomJS),
</span></span><span style="display:flex;"><span>      httpSwagger.<span style="color:#50fa7b">DocExpansion</span>(<span style="color:#f1fa8c">&#34;none&#34;</span>),
</span></span><span style="display:flex;"><span>      httpSwagger.<span style="color:#50fa7b">UIConfig</span>(<span style="color:#8be9fd;font-style:italic">map</span>[<span style="color:#8be9fd">string</span>]<span style="color:#8be9fd">string</span>{
</span></span><span style="display:flex;"><span>      <span style="color:#f1fa8c">&#34;defaultModelsExpandDepth&#34;</span>: <span style="color:#f1fa8c">`&#34;-1&#34;`</span>,
</span></span><span style="display:flex;"><span>      }),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    r.<span style="color:#50fa7b">Get</span>(<span style="color:#f1fa8c">&#34;/user&#34;</span>, handler.GetUser)
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><code>httpSwagger.AfterScript(custom.CustomJS)</code>: Isso injeta nosso JS no swagger depois da página ser carregada.
<code>httpSwagger.DocExpansion(&quot;none&quot;)</code>: Isso faz com que cada o endpoint abre expandido ou não (gosto pessoal), mas ajuda quando sua documentação possui muitos endpoints, no exemplo o <code>-1</code> faz com que por padrão não fique expandido as rotas.
<code>&quot;defaultModelsExpandDepth&quot;: &quot;-1&quot;</code>: Isso faz com que os models sejam ocultos, caso precise deixar visível basta remover.</p>
<p>Existe mais opções possíveis nas <a href="https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/">docs</a> do swagger.</p>
<p>Agora rodando novamente nosso projeto, já teremos o swagger em dark mode:
<img alt="Swaggo dark mode" src="/posts/dark-mode-swaggo/0s9g7ansY45Joi.png"></p>
<p><img alt="Meme liked" src="https://media.giphy.com/media/m2Q7FEc0bEr4I/giphy.gif"></p>
<h2 id="personalizando-ainda-mais">Personalizando ainda mais</h2>
<p>Agora com o poder da manipulação da DOM e com paciência, podemos modificar o layout da forma que desejarmos, vamos por exemplo altera a logo e favicon e o title.</p>
<p>Vamos modificar nosso <code>custom_layout.go</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">var</span> CustomJS = fmt.<span style="color:#50fa7b">Sprintf</span>(<span style="color:#f1fa8c">`
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    // set custom title
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      document.title = &#39;Swagger Dark Mode With Go&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      // set custom favicon
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      const link = document.createElement(&#39;link&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      link.rel = &#39;icon&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      link.type = &#39;image/x-icon&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      link.href = &#39;data:image/png;base64,%s&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      document.head.appendChild(link);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      // set custom logo
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      const image = document.querySelector(&#39;.link img&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      const base64URL = &#39;data:image/png;base64,%s&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      image.src = base64URL;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      // dark mode
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      const style = document.createElement(&#39;style&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      style.innerHTML = %s;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      document.head.appendChild(style);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    `</span>, CustomLogo, CustomLogo, <span style="color:#f1fa8c">&#34;`&#34;</span><span style="color:#ff79c6">+</span>customCSS<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;`&#34;</span>)
</span></span></code></pre></div><p>Adicionei um title, favicon e logo, usando um base64 para as imagens. Salvamos esse base64 em um arquivo chamado <code>images.go</code> dentro da pasta <code>custom</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>  <span style="color:#ff79c6">package</span> custom
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">var</span> (
</span></span><span style="display:flex;"><span>    CustomLogo = <span style="color:#f1fa8c">`base64 aqui`</span>
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div><p>Apenas como exemplo, o favicon e a logo foram utilizados a mesma imagem em base64, mas você poderia separar, veja como ficou:
<img alt="Swaggo dar mode" src="/posts/dark-mode-swaggo/fg89Peer124gfh567ghjJK78.png"></p>
<h2 id="considerações-finais">Considerações finais</h2>
<p>Como podemos ver, não é tão complicado personalizar, apesar da personalização ser um pouco trabalhosa e parecer não ser a mais adequeada, ainda conseguimos deixar o tema do swagger com uma aparência mais agradável para quem for consumir nossa api.</p>
<h2 id="link-do-repositório">Link do repositório</h2>
<p><a href="https://github.com/wiliamvj/swagger-dark-mode">repositório</a> do projeto</p>
</section>

  
    
  
    <div class="giscus-comment">
    <script
      src="https://giscus.app/client.js"
      data-repo="wiliamvj/wiliamvj.com"
      data-repo-id="R_kgDOKqMPTA"
      data-category="General"
      data-category-id="DIC_kwDOKqMPTM4CbzWf"
      data-mapping="pathname"
      data-strict="0"
      data-reactions-enabled="1"
      data-emit-metadata="0"
      data-input-position="top"
      data-theme="dark"
      data-lang="en"
      
        data-loading="lazy"
      
      crossorigin="anonymous"
      async
    >
    </script>
</div>
  

    
  


  <footer>
    
  </footer>
</article>

</main><footer class="pt-5 pb-6 lg:grid lg:gap-3 lg:grid-cols-2">
  <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2024 —
  <a href="//localhost:1313/">Wiliam V. Joaquim</a> 
  <span class="font-normal">with</span>
  <a
    href="https://github.com/nixentric/Lowkey-Hugo-Theme"
    target="_blank"
    rel="noopener noreferrer"
  >
    Lowkey
  </a>
</div>
 <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
     
    <li>
      <a href="https://www.linkedin.com/in/wiliamvj/" target="_blank" rel="noopener noreferrer"
        >linkedin</a
      >
    </li>
    
    <li>
      <a href="https://twitter.com/wiliamjoaquim" target="_blank" rel="noopener noreferrer"
        >x</a
      >
    </li>
    
    <li>
      <a href="https://github.com/wiliamvj" target="_blank" rel="noopener noreferrer"
        >github</a
      >
    </li>
    
    <li>
      <a href="https://dev.to/wiliamvj" target="_blank" rel="noopener noreferrer"
        >dev.to</a
      >
    </li>
     
  </ul>
</div>

</footer>
</body>
</html>
